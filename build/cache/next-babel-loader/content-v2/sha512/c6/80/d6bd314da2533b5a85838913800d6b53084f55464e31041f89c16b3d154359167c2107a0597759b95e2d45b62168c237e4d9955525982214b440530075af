{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useEffect, useState } from 'react';\nimport { Button, Form, Input, message, Row, Spin, Typography } from 'antd';\nimport { LoadingOutlined } from '@ant-design/icons';\nimport axiosClient from '../../../../../utils/axios-config';\nimport FacebookLoginComp from '../../../../auth/facebookAuth';\nimport GoogleLoginComp from '../../../../auth/googleAuth';\nconst {\n  Text\n} = Typography;\n\nconst Step1 = ({\n  form,\n  prevStep,\n  nextStep,\n  onClick\n}) => {\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n\n  const continueHandler = async () => {\n    setLoading(true);\n\n    try {\n      const errors = await form.validateFields();\n    } catch (errors) {\n      setLoading(false);\n      return;\n    }\n\n    const {\n      email\n    } = form.getFieldsValue(true); // send verify token\n\n    try {\n      var _res$result, _res$message;\n\n      const res = await axiosClient.post(\"user/\", {\n        email\n      });\n      console.log(res); // if user doesn't already exists & is sent verification email\n\n      if ((res === null || res === void 0 ? void 0 : res.status) === 201 || (res === null || res === void 0 ? void 0 : (_res$result = res.result) === null || _res$result === void 0 ? void 0 : _res$result.verification_email_status) === \"pending\") {\n        nextStep();\n      }\n\n      if (res !== null && res !== void 0 && (_res$message = res.message) !== null && _res$message !== void 0 && _res$message.includes(\"Already registered\")) message.error(res.message);\n    } catch (error) {\n      message.error(error.message);\n      console.log(error);\n    }\n\n    setLoading(false);\n    console.log(\"No errors FOUND\");\n  };\n\n  const googleHandler = async ({\n    profileObj\n  }) => {\n    try {\n      const {\n        email,\n        name,\n        googleId: provider_user_id,\n        imageUrl: imagePath\n      } = profileObj;\n      const userData = {\n        email,\n        name,\n        provider_user_id,\n        imagePath,\n        provider: \"google\",\n        user_type: \"user\"\n      };\n      const res = await axiosClient.post(\"user/socialauth/register\", userData);\n      console.log(res);\n      nextStep(2);\n    } catch (error) {\n      var _error$response, _error$response$data;\n\n      message.error(error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message);\n    }\n  };\n\n  const facebookHandler = async ({\n    email,\n    name,\n    userID: provider_user_id,\n    picture\n  }) => {\n    try {\n      var _picture$data;\n\n      const userData = {\n        email,\n        name,\n        provider_user_id,\n        imagePath: picture === null || picture === void 0 ? void 0 : (_picture$data = picture.data) === null || _picture$data === void 0 ? void 0 : _picture$data.url,\n        provider: \"facebook\",\n        user_type: \"user\"\n      };\n      console.log(userData);\n      const res = await axiosClient.post(\"user/socialauth/register\", userData);\n      nextStep(2);\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n\n      message.error(error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message);\n    }\n  };\n\n  useEffect(() => {\n    form.setFields([{\n      name: \"user_type\",\n      value: \"user\"\n    }]);\n  }, []);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"flex flex-row justify-between align-center mb-6\",\n      children: [/*#__PURE__*/_jsx(Text, {\n        className: \"text-4xl font-extrabold\",\n        children: \"Sign Up\"\n      }), /*#__PURE__*/_jsx(\"img\", {\n        src: \"/images/close.png\",\n        alt: \"close\",\n        className: \"h-4 w-4 cursor-pointer\",\n        onClick: onClick\n      })]\n    }), /*#__PURE__*/_jsxs(Text, {\n      className: \"my-8\",\n      children: [\"or\", /*#__PURE__*/_jsx(Text, {\n        className: \"text-red-500 ml-2\",\n        children: \"login to your account\"\n      })]\n    }), /*#__PURE__*/_jsxs(Form, {\n      form: form,\n      name: \"signup-form\",\n      className: \"mt-10\",\n      layout: \"vertical\",\n      children: [/*#__PURE__*/_jsx(Form.Item, {\n        name: \"phone\",\n        rules: [{\n          required: false,\n          message: \"Please input your phone number\"\n        }],\n        children: /*#__PURE__*/_jsx(Input, {\n          className: \"signup-input\",\n          placeholder: \"Phone Number\",\n          type: \"integer\"\n        })\n      }), /*#__PURE__*/_jsx(Form.Item, {\n        name: \"name\",\n        rules: [{\n          required: true,\n          message: \"Please input your name\"\n        }],\n        children: /*#__PURE__*/_jsx(Input, {\n          className: \"signup-input\",\n          placeholder: \"Name\",\n          type: \"text\"\n        })\n      }), /*#__PURE__*/_jsx(Form.Item, {\n        name: \"email\",\n        rules: [{\n          required: true,\n          message: \"Please input your email\",\n          type: \"email\"\n        }],\n        children: /*#__PURE__*/_jsx(Input, {\n          className: \"signup-input\",\n          placeholder: \"Email\",\n          type: \"email\"\n        })\n      }), /*#__PURE__*/_jsx(Form.Item, {\n        name: \"password\",\n        rules: [{\n          required: true,\n          message: \"Please input password\"\n        }],\n        children: /*#__PURE__*/_jsx(Input.Password, {\n          className: \"signup-input px-6 py-4 bg-inputBg\",\n          placeholder: \"Password\"\n        })\n      }), /*#__PURE__*/_jsx(Text, {\n        className: \"mb-6\",\n        children: \"Have a referral code?\"\n      }), /*#__PURE__*/_jsx(Form.Item, {\n        children: /*#__PURE__*/_jsxs(Button, {\n          className: \"py-6 flex flex-row gap-2 justify-center items-center\",\n          block: true,\n          type: \"primary\",\n          htmlType: \"submit\",\n          onClick: () => continueHandler(),\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            children: \"Continue\"\n          }), loading && /*#__PURE__*/_jsx(Spin, {\n            indicator: /*#__PURE__*/_jsx(LoadingOutlined, {\n              style: {\n                fontSize: 24,\n                color: \"white\"\n              },\n              spin: true\n            })\n          })]\n        })\n      })]\n    }), /*#__PURE__*/_jsxs(Text, {\n      children: [\"By creating an account, I accept the \", /*#__PURE__*/_jsx(Text, {\n        className: \"text-red-500\",\n        children: \"Terms & Conditions\"\n      })]\n    }), /*#__PURE__*/_jsx(Text, {\n      className: \"text-center block mt-8 mb-4 font-semibold text-base md:text-xl\",\n      children: \"Or Sign Up With\"\n    }), /*#__PURE__*/_jsxs(Row, {\n      className: \"flex justify-center items-center gap-2 md:gap-4\",\n      children: [/*#__PURE__*/_jsx(FacebookLoginComp, {\n        handler: facebookHandler\n      }), /*#__PURE__*/_jsx(GoogleLoginComp, {\n        handler: googleHandler\n      })]\n    })]\n  });\n};\n\nexport default Step1;","map":null,"metadata":{},"sourceType":"module"}