{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n    display: flex;\\n    align-items: center;\\n    justify-content: flex-start;\\n    margin-top: 16px;\\n    width: 100%;\\n\\n    @media (max-width: 768px) {\\n      flex-direction: column;\\n      justify-content: center;\\n    }\\n  \"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport { ClockCircleOutlined } from \"@ant-design/icons\";\nimport { Button, Col, Divider, Row, Table, Tabs, Typography } from \"antd\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { fetchFood } from \"../../../redux/actions/food\";\nimport { asyncLocalStorage } from \"../../../utils/localStorage\";\nimport { addToCart, decreaseItemToCart, increaseItemToCart } from \"../../../redux/actions/cart/cartAction\";\nimport styled from \"styled-components\";\nimport { useLocalStorageState } from \"ahooks\";\nimport Head from \"next/head\";\nimport { useSession } from \"next-auth/client\";\nvar TabPane = Tabs.TabPane;\nvar Text = Typography.Text;\n\nvar ClockIcon = function ClockIcon() {\n  return /*#__PURE__*/_jsx(\"img\", {\n    src: \"/images/clock.png\",\n    className: \"w-3 h-3\",\n    alt: \"clock\"\n  });\n};\n\nvar TruckIcon = function TruckIcon() {\n  return /*#__PURE__*/_jsx(\"img\", {\n    src: \"/images/truck.png\",\n    alt: \"truck\",\n    className: \"h-3 w-auto\"\n  });\n};\n\nvar CartIcon = function CartIcon() {\n  return /*#__PURE__*/_jsx(\"img\", {\n    src: \"/images/cart.png\",\n    alt: \"cart\",\n    className: \"w-4 h-4\"\n  });\n};\n\nvar StarIcon = function StarIcon() {\n  return /*#__PURE__*/_jsx(\"img\", {\n    className: \"w-3 h-3\",\n    src: \"/images/star-yellow.png\",\n    alt: \"rating\"\n  });\n};\n\nvar TabName = function TabName(_ref) {\n  var name = _ref.name;\n  return /*#__PURE__*/_jsx(Text, {\n    strong: true,\n    className: \"text-black\",\n    children: name\n  });\n};\n\nvar FoodDetailContent = function FoodDetailContent(_ref2) {\n  var _selectedFood$PlateIm;\n\n  var foodId = _ref2.foodId,\n      data = _ref2.data,\n      platesRelated = _ref2.platesRelated;\n\n  var _useSession = useSession(),\n      _useSession2 = _slicedToArray(_useSession, 1),\n      session = _useSession2[0];\n\n  var dispatch = useDispatch();\n\n  var _useState = useState(\"\"),\n      page1 = _useState[0],\n      setPage1 = _useState[1];\n\n  var _useLocalStorageState = useLocalStorageState(\"cartitems\", {\n    items: []\n  }),\n      _useLocalStorageState2 = _slicedToArray(_useLocalStorageState, 2),\n      cartitems = _useLocalStorageState2[0],\n      setCartitems = _useLocalStorageState2[1];\n\n  var selectedFood = Object.assign(data);\n  var image_url = selectedFood === null || selectedFood === void 0 ? void 0 : (_selectedFood$PlateIm = selectedFood.PlateImages[0]) === null || _selectedFood$PlateIm === void 0 ? void 0 : _selectedFood$PlateIm.url;\n  var chefImage = selectedFood.chef.image ? selectedFood.chef.image : \"/images/chef/chef.jpg\";\n  var rating = selectedFood.rating ? selectedFood.rating : \"no rating yet\";\n\n  var _useState2 = useState(1),\n      numberof = _useState2[0],\n      setNumber = _useState2[1];\n\n  var _useState3 = useState(1),\n      basketItemId = _useState3[0],\n      setBasketItemId = _useState3[1];\n\n  var _useState4 = useState(false),\n      inCart = _useState4[0],\n      setInCart = _useState4[1];\n\n  var router = useRouter();\n  var deliveryType = \"user\";\n  useEffect( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            dispatch(fetchFood());\n            setPage1(0);\n            console.log(cartitems); // try {\n            //   const plateId = foodId;\n            //   let cartitems = await asyncLocalStorage.getItem(\"cartitems\");\n            //   cartitems = JSON.parse(cartitems);\n            //   // console.log(cartitems)\n            //   cartitems[\"items\"].forEach((item) => {\n            //     // console.log(item)\n            //     if (item.plateId == plateId) {\n            //       // console.log(\"Already in the cart.!\");\n            //       setInCart(true);\n            //     }\n            //   });\n            // } catch (e) {\n            //   console.log(e);\n            // }\n\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), [cartitems, session]);\n\n  var AddOne = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(numberof < 10)) {\n                _context2.next = 5;\n                break;\n              }\n\n              setNumber(numberof + 1);\n\n              if (!session) {\n                _context2.next = 5;\n                break;\n              }\n\n              _context2.next = 5;\n              return dispatch(increaseItemToCart(basketItemId, deliveryType));\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function AddOne() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var removeOne = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!(numberof > 1)) {\n                _context3.next = 5;\n                break;\n              }\n\n              setNumber(numberof - 1);\n\n              if (!session) {\n                _context3.next = 5;\n                break;\n              }\n\n              _context3.next = 5;\n              return dispatch(decreaseItemToCart(basketItemId, deliveryType));\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function removeOne() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var goTocart = function goTocart() {\n    router.push(\"/cart\");\n  };\n\n  var AddtoCart = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var param, basketItem, cartitems, plateId, orderednumber, item, inCartFlag;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              // console.log(asyncLocalStorage)\n              param = {\n                plates: [{\n                  quantity: numberof,\n                  plateId: foodId,\n                  note: \"Special Instructions goes here\"\n                }],\n                deliveryType: \"user\"\n              };\n\n              if (!session) {\n                _context4.next = 8;\n                break;\n              }\n\n              _context4.next = 4;\n              return dispatch(addToCart(param));\n\n            case 4:\n              basketItem = _context4.sent;\n\n              if (basketItem.items.length > 0) {\n                setBasketItemId(basketItem.items[0].basketItemId);\n              }\n\n              _context4.next = 10;\n              break;\n\n            case 8:\n              _context4.next = 10;\n              return dispatch(addToCart(param));\n\n            case 10:\n              _context4.next = 12;\n              return asyncLocalStorage.getItem(\"cartitems\");\n\n            case 12:\n              cartitems = _context4.sent;\n              // console.log(cartitems)\n              plateId = foodId;\n              orderednumber = numberof;\n              item = {\n                plateId: plateId,\n                ordered: orderednumber\n              };\n              inCartFlag = false;\n\n              if (cartitems) {\n                _context4.next = 25;\n                break;\n              }\n\n              _context4.next = 20;\n              return asyncLocalStorage.setItem(\"cartitems\", JSON.stringify({\n                items: [item]\n              }));\n\n            case 20:\n              setInCart(true);\n              inCartFlag = true;\n              console.log(\"Added to cart.!\");\n              _context4.next = 33;\n              break;\n\n            case 25:\n              cartitems = JSON.parse(cartitems); // console.log(cartitems)\n\n              cartitems[\"items\"].forEach(function (item) {\n                // console.log(item)\n                if (item.plateId.toString() === plateId.toString()) {\n                  console.log(\"Already in the cart.!\");\n                  setInCart(true);\n                  inCartFlag = true; // return\n                }\n              });\n\n              if (inCartFlag) {\n                _context4.next = 33;\n                break;\n              }\n\n              // console.log(\"Not first or not in cart too\")\n              cartitems[\"items\"].push(item);\n              console.log(\"Pushed.!\");\n              _context4.next = 32;\n              return asyncLocalStorage.setItem(\"cartitems\", JSON.stringify(cartitems));\n\n            case 32:\n              setInCart(true);\n\n            case 33:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function AddtoCart() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  var handlePrev = function handlePrev() {\n    setPage1(page1 - 3);\n  };\n\n  var handleNext = function handleNext() {\n    setPage1(page1 + 3);\n  };\n\n  var columns = [{\n    title: \"Ingredients\",\n    dataIndex: \"Ingredients\",\n    key: \"Ingredients\"\n  }, {\n    title: \"Purchase Date\",\n    dataIndex: \"Date\",\n    key: \"Date\"\n  }];\n  var dataSource = [{\n    key: \"1\",\n    Ingredients: \"1.Tomato\",\n    Date: \"8-19-19\"\n  }, {\n    key: \"2\",\n    Ingredients: \"2.Water\",\n    Date: \"8-19-19\"\n  }, {\n    key: \"3\",\n    Ingredients: \"3.Egg\",\n    Date: \"8-19-19\"\n  }];\n  var FlexBox = styled.div(_templateObject());\n\n  var getBackgrounStyle = function getBackgrounStyle(plate) {\n    var _plate$PlateImages$;\n\n    if (plate !== null && plate !== void 0 && (_plate$PlateImages$ = plate.PlateImages[0]) !== null && _plate$PlateImages$ !== void 0 && _plate$PlateImages$.url) {\n      var _plate$PlateImages$2;\n\n      return \"url(\".concat(plate === null || plate === void 0 ? void 0 : (_plate$PlateImages$2 = plate.PlateImages[0]) === null || _plate$PlateImages$2 === void 0 ? void 0 : _plate$PlateImages$2.url, \")\");\n    }\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [selectedFood ? /*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsxs(\"title\", {\n        children: [\"Order - \", selectedFood.name]\n      })\n    }) : /*#__PURE__*/_jsx(Head, {\n      children: /*#__PURE__*/_jsx(\"title\", {\n        children: \"Loading..\"\n      })\n    }), /*#__PURE__*/_jsx(Row, {\n      className: \"w-full bg-fixed bg-cover bg-no-repeat bg-center relative mt-12\",\n      style: {\n        backgroundImage: \"url(\".concat(image_url, \")\"),\n        height: \"40vh\",\n        backgroundSize: \"cover\",\n        filter: \"brightness(30%)\"\n      },\n      justify: \"center\",\n      align: \"middle\"\n    }), /*#__PURE__*/_jsx(Row, {\n      className: \"absolute w-full\",\n      style: {\n        height: \"40vh\",\n        transform: \"translateY(-100%)\"\n      },\n      justify: \"center\",\n      align: \"middle\",\n      children: /*#__PURE__*/_jsxs(Col, {\n        children: [/*#__PURE__*/_jsx(Text, {\n          strong: true,\n          className: \"block text-white text-3xl\",\n          children: selectedFood.name\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"flex flex-row justify-center mt-2\",\n          children: [/*#__PURE__*/_jsx(ClockCircleOutlined, {\n            className: \"text-white mt-1\"\n          }), /*#__PURE__*/_jsxs(Text, {\n            className: \"ml-3 text-white text-center\",\n            children: [selectedFood.delivery_time, \" Min\"]\n          })]\n        })]\n      })\n    }), /*#__PURE__*/_jsxs(Row, {\n      className: \"pt-2 pb-4 mx-auto w-3/5 sm:w-100\",\n      justify: \"center\",\n      align: \"bottom\",\n      children: [/*#__PURE__*/_jsx(Col, {\n        span: 5,\n        xs: 14,\n        sm: 16,\n        md: 5,\n        className: \"mt-16\",\n        children: /*#__PURE__*/_jsx(\"img\", {\n          src: chefImage,\n          alt: selectedFood.chef.name,\n          className: \"w-100 mb-6 md:mb-0 block\"\n        })\n      }), /*#__PURE__*/_jsx(Col, {\n        span: 1\n      }), /*#__PURE__*/_jsxs(Col, {\n        span: 18,\n        className: \"pb-2\",\n        xs: 22,\n        sm: 22,\n        md: 18,\n        children: [/*#__PURE__*/_jsx(FlexBox, {\n          children: /*#__PURE__*/_jsx(Col, {\n            children: /*#__PURE__*/_jsx(Text, {\n              strong: true,\n              className: \"text-2xl font-bold\",\n              children: selectedFood.chef.name\n            })\n          })\n        }), /*#__PURE__*/_jsx(Row, {\n          children: /*#__PURE__*/_jsxs(FlexBox, {\n            children: [/*#__PURE__*/_jsxs(\"span\", {\n              className: \"flex flex-row items-center mt-2 mb-2\",\n              children: [/*#__PURE__*/_jsx(StarIcon, {}), /*#__PURE__*/_jsxs(Text, {\n                className: \"ml-2\",\n                children: [rating, \" (\", selectedFood.reviews.length + 1, \")\"]\n              })]\n            }), /*#__PURE__*/_jsxs(\"span\", {\n              className: \"mx-7 flex flex-row justify-center items-center mt-2 mb-2\",\n              children: [/*#__PURE__*/_jsx(ClockIcon, {}), /*#__PURE__*/_jsxs(Text, {\n                className: \"ml-2 text-center\",\n                children: [selectedFood.delivery_time, \" Min\"]\n              })]\n            }), /*#__PURE__*/_jsxs(\"span\", {\n              className: \"flex flex-row items-center mt-2 mb-2\",\n              children: [/*#__PURE__*/_jsx(TruckIcon, {}), /*#__PURE__*/_jsx(Text, {\n                className: \"ml-2\",\n                children: \"Delivery\"\n              })]\n            })]\n          })\n        })]\n      })]\n    }), /*#__PURE__*/_jsx(Row, {\n      className: \"w-3/5 mx-auto\",\n      children: /*#__PURE__*/_jsx(Divider, {\n        style: {\n          backgroundColor: \"#A0AEC0\"\n        }\n      })\n    }), /*#__PURE__*/_jsx(Row, {\n      className: \"my-2 mx-auto w-3/5\",\n      align: \"middle\",\n      sm: 12,\n      children: /*#__PURE__*/_jsxs(FlexBox, {\n        children: [/*#__PURE__*/_jsxs(\"h1\", {\n          className: \"text-2xl font-bold md:mb-0 xs:mb-3\",\n          children: [\"$\", selectedFood.price]\n        }), /*#__PURE__*/_jsxs(Button, {\n          onClick: function onClick() {\n            if (inCart) {\n              goTocart();\n            } else {\n              AddtoCart();\n            }\n          },\n          size: \"large\",\n          type: \"primary\",\n          className: \"flex flex-row items-center mx-4 rounded-none\",\n          children: [/*#__PURE__*/_jsx(CartIcon, {}), inCart ? /*#__PURE__*/_jsx(\"p\", {\n            className: \"ml-2\",\n            children: \"Go to Cart\"\n          }) : /*#__PURE__*/_jsx(\"p\", {\n            className: \"ml-2\",\n            children: \"Add to Cart\"\n          })]\n        }), /*#__PURE__*/_jsxs(\"span\", {\n          style: {\n            backgroundColor: \"#EDF2F7\",\n            borderBottom: \"1px solid #A0AEC0\",\n            display: \"inline-block\"\n          },\n          className: \"md:mt-0 xs:mt-5\",\n          children: [/*#__PURE__*/_jsx(Button, {\n            onClick: removeOne,\n            size: \"large\",\n            className: \"border-none text-black rounded-none\",\n            ghost: true,\n            children: \" - \"\n          }), /*#__PURE__*/_jsx(Text, {\n            className: \"md:mx-2 xs:mx-0\",\n            children: numberof\n          }), /*#__PURE__*/_jsx(Button, {\n            onClick: AddOne,\n            size: \"large\",\n            className: \"border-none text-black rounded-none\",\n            ghost: true,\n            children: \" + \"\n          })]\n        })]\n      })\n    }), /*#__PURE__*/_jsx(Row, {\n      className: \"w-3/5 mx-auto\",\n      children: /*#__PURE__*/_jsx(Divider, {\n        style: {\n          backgroundColor: \"#A0AEC0\"\n        }\n      })\n    }), /*#__PURE__*/_jsx(Row, {\n      className: \"w-3/5 mx-auto mb-10\",\n      children: /*#__PURE__*/_jsx(Col, {\n        span: 24,\n        children: /*#__PURE__*/_jsxs(Tabs, {\n          defaultActiveKey: \"1\",\n          size: \"large\",\n          children: [/*#__PURE__*/_jsxs(TabPane, {\n            tab: /*#__PURE__*/_jsx(TabName, {\n              name: \"The Plate\"\n            }),\n            children: [/*#__PURE__*/_jsx(Text, {\n              className: \"mb-6 mt-2 block\",\n              children: selectedFood.description\n            }), /*#__PURE__*/_jsx(Table, {\n              pagination: false,\n              dataSource: dataSource,\n              columns: columns\n            })]\n          }, \"1\"), /*#__PURE__*/_jsx(TabPane, {\n            tab: /*#__PURE__*/_jsx(TabName, {\n              name: \"Kitchen\"\n            }),\n            children: \"Content of Tab Pane 2\"\n          }, \"2\"), /*#__PURE__*/_jsx(TabPane, {\n            tab: /*#__PURE__*/_jsx(TabName, {\n              name: \"Recipe\"\n            }),\n            children: \"Content of Tab Pane 3\"\n          }, \"3\"), /*#__PURE__*/_jsx(TabPane, {\n            tab: /*#__PURE__*/_jsx(TabName, {\n              name: \"Review\"\n            }),\n            children: \"Content of Tab Pane 4\"\n          }, \"4\")]\n        })\n      })\n    }), /*#__PURE__*/_jsxs(Row, {\n      className: \"w-3/5 mx-auto mb-10\",\n      justify: \"space-between\",\n      align: \"middle\",\n      children: [/*#__PURE__*/_jsx(Col, {\n        children: /*#__PURE__*/_jsx(Text, {\n          strong: true,\n          className: \"md:text-3xl font-bold xs:text-2xl\",\n          children: \"Other Plates\"\n        })\n      }), /*#__PURE__*/_jsx(Col, {\n        children: /*#__PURE__*/_jsxs(\"span\", {\n          className: \"flex flex-row space-x-4\",\n          children: [/*#__PURE__*/_jsx(Button, {\n            className: \"border-none rounded-none\",\n            disabled: page1 === 0,\n            onClick: handlePrev,\n            children: /*#__PURE__*/_jsx(\"img\", {\n              onClick: handlePrev,\n              src: \"/images/page-left.png\"\n            })\n          }), /*#__PURE__*/_jsx(Button, {\n            className: \"border-none rounded-none\",\n            disabled: page1 >= data.length - 1,\n            onClick: handleNext,\n            children: /*#__PURE__*/_jsx(\"img\", {\n              onClick: handlePrev,\n              src: \"/images/page-right.png\"\n            })\n          })]\n        })\n      })]\n    }), /*#__PURE__*/_jsx(Row, {\n      xs: 12,\n      className: \"other-plate-grid flex justify-center md:pl-20 md:pr-20\",\n      children: platesRelated.map(function (plate, index) {\n        return index >= page1 && index < page1 + 3 && /*#__PURE__*/_jsx(Col, {\n          className: \"new-food-card md:p-8 mb-6\",\n          xs: 16,\n          xxl: 16,\n          sm: 16,\n          md: 16,\n          lg: 8,\n          xl: 6,\n          children: /*#__PURE__*/_jsx(Link, {\n            href: \"/food-detail/\".concat(encodeURIComponent(plate.id)),\n            children: /*#__PURE__*/_jsxs(\"a\", {\n              children: [/*#__PURE__*/_jsx(Row, {\n                justify: \"center\",\n                className: \"other-food-image h-40\",\n                style: {\n                  backgroundImage: getBackgrounStyle(),\n                  backgroundSize: \"cover\"\n                }\n              }), /*#__PURE__*/_jsx(Row, {\n                children: /*#__PURE__*/_jsx(Text, {\n                  className: \"mt-4 mb-1\",\n                  children: plate.name\n                })\n              }), /*#__PURE__*/_jsxs(Row, {\n                children: [/*#__PURE__*/_jsx(Col, {\n                  span: 8,\n                  children: /*#__PURE__*/_jsxs(Row, {\n                    align: \"middle\",\n                    children: [/*#__PURE__*/_jsx(StarIcon, {}), /*#__PURE__*/_jsx(Text, {\n                      className: \"ml-2\",\n                      children: plate.rating ? plate.rating : \"no rating yet\"\n                    })]\n                  })\n                }), /*#__PURE__*/_jsx(Col, {\n                  span: 8,\n                  children: /*#__PURE__*/_jsxs(Row, {\n                    align: \"middle\",\n                    children: [/*#__PURE__*/_jsx(ClockIcon, {}), /*#__PURE__*/_jsxs(Text, {\n                      className: \"ml-2\",\n                      children: [plate === null || plate === void 0 ? void 0 : plate.delivery_time, \" Min\"]\n                    })]\n                  })\n                }), /*#__PURE__*/_jsx(Col, {\n                  span: 8,\n                  children: /*#__PURE__*/_jsxs(Row, {\n                    align: \"middle\",\n                    justify: \"end\",\n                    children: [/*#__PURE__*/_jsx(TruckIcon, {}), /*#__PURE__*/_jsx(Text, {\n                      className: \"ml-2\",\n                      children: \"Delivery\"\n                    })]\n                  })\n                })]\n              })]\n            })\n          })\n        }, plate.id);\n      })\n    })]\n  });\n};\n\nexport default FoodDetailContent;","map":null,"metadata":{},"sourceType":"module"}