{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useEffect, useState } from 'react';\nimport { Button, Form, Input, message, Row, Spin, Typography } from 'antd';\nimport { LoadingOutlined } from '@ant-design/icons';\nimport axiosClient from '../../../../../utils/axios-config';\nimport FacebookLoginComp from '../../../../auth/facebookAuth';\nimport GoogleLoginComp from '../../../../auth/googleAuth';\nvar Text = Typography.Text;\n\nvar Step1 = function Step1(_ref) {\n  var form = _ref.form,\n      prevStep = _ref.prevStep,\n      nextStep = _ref.nextStep,\n      onClick = _ref.onClick;\n\n  var _useState = useState(false),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var continueHandler = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var errors, _form$getFieldsValue, email, _res$result, _res$message, res;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n              _context.prev = 1;\n              _context.next = 4;\n              return form.validateFields();\n\n            case 4:\n              errors = _context.sent;\n              _context.next = 11;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](1);\n              setLoading(false);\n              return _context.abrupt(\"return\");\n\n            case 11:\n              _form$getFieldsValue = form.getFieldsValue(true), email = _form$getFieldsValue.email; // send verify token\n\n              _context.prev = 12;\n              _context.next = 15;\n              return axiosClient.post(\"user/\", {\n                email: email\n              });\n\n            case 15:\n              res = _context.sent;\n              console.log(res); // if user doesn't already exists & is sent verification email\n\n              if ((res === null || res === void 0 ? void 0 : res.status) === 201 || (res === null || res === void 0 ? void 0 : (_res$result = res.result) === null || _res$result === void 0 ? void 0 : _res$result.verification_email_status) === \"pending\") {\n                nextStep();\n              }\n\n              if (res !== null && res !== void 0 && (_res$message = res.message) !== null && _res$message !== void 0 && _res$message.includes(\"Already registered\")) message.error(res.message);\n              _context.next = 25;\n              break;\n\n            case 21:\n              _context.prev = 21;\n              _context.t1 = _context[\"catch\"](12);\n              message.error(_context.t1.message);\n              console.log(_context.t1);\n\n            case 25:\n              setLoading(false);\n              console.log(\"No errors FOUND\");\n\n            case 27:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 7], [12, 21]]);\n    }));\n\n    return function continueHandler() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var googleHandler = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref3) {\n      var profileObj, email, name, provider_user_id, imagePath, userData, res, _error$response, _error$response$data;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              profileObj = _ref3.profileObj;\n              _context2.prev = 1;\n              email = profileObj.email, name = profileObj.name, provider_user_id = profileObj.googleId, imagePath = profileObj.imageUrl;\n              userData = {\n                email: email,\n                name: name,\n                provider_user_id: provider_user_id,\n                imagePath: imagePath,\n                provider: \"google\",\n                user_type: \"user\"\n              };\n              _context2.next = 6;\n              return axiosClient.post(\"user/socialauth/register\", userData);\n\n            case 6:\n              res = _context2.sent;\n              console.log(res);\n              nextStep(2);\n              _context2.next = 14;\n              break;\n\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](1);\n              message.error(_context2.t0 === null || _context2.t0 === void 0 ? void 0 : (_error$response = _context2.t0.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message);\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 11]]);\n    }));\n\n    return function googleHandler(_x) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var facebookHandler = /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref5) {\n      var email, name, provider_user_id, picture, _picture$data, userData, res, _error$response2, _error$response2$data;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              email = _ref5.email, name = _ref5.name, provider_user_id = _ref5.userID, picture = _ref5.picture;\n              _context3.prev = 1;\n              userData = {\n                email: email,\n                name: name,\n                provider_user_id: provider_user_id,\n                imagePath: picture === null || picture === void 0 ? void 0 : (_picture$data = picture.data) === null || _picture$data === void 0 ? void 0 : _picture$data.url,\n                provider: \"facebook\",\n                user_type: \"user\"\n              };\n              console.log(userData);\n              _context3.next = 6;\n              return axiosClient.post(\"user/socialauth/register\", userData);\n\n            case 6:\n              res = _context3.sent;\n              nextStep(2);\n              _context3.next = 13;\n              break;\n\n            case 10:\n              _context3.prev = 10;\n              _context3.t0 = _context3[\"catch\"](1);\n              message.error(_context3.t0 === null || _context3.t0 === void 0 ? void 0 : (_error$response2 = _context3.t0.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message);\n\n            case 13:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[1, 10]]);\n    }));\n\n    return function facebookHandler(_x2) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    form.setFields([{\n      name: \"user_type\",\n      value: \"user\"\n    }]);\n  }, []);\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"flex flex-row justify-between align-center mb-6\",\n      children: [/*#__PURE__*/_jsx(Text, {\n        className: \"text-4xl font-extrabold\",\n        children: \"Sign Up\"\n      }), /*#__PURE__*/_jsx(\"img\", {\n        src: \"/images/close.png\",\n        alt: \"close\",\n        className: \"h-4 w-4 cursor-pointer\",\n        onClick: onClick\n      })]\n    }), /*#__PURE__*/_jsxs(Text, {\n      className: \"my-8\",\n      children: [\"or\", /*#__PURE__*/_jsx(Text, {\n        className: \"text-red-500 ml-2\",\n        children: \"login to your account\"\n      })]\n    }), /*#__PURE__*/_jsxs(Form, {\n      form: form,\n      name: \"signup-form\",\n      className: \"mt-10\",\n      layout: \"vertical\",\n      children: [/*#__PURE__*/_jsx(Form.Item, {\n        name: \"phone\",\n        rules: [{\n          required: false,\n          message: \"Please input your phone number\"\n        }],\n        children: /*#__PURE__*/_jsx(Input, {\n          className: \"signup-input\",\n          placeholder: \"Phone Number\",\n          type: \"integer\"\n        })\n      }), /*#__PURE__*/_jsx(Form.Item, {\n        name: \"name\",\n        rules: [{\n          required: true,\n          message: \"Please input your name\"\n        }],\n        children: /*#__PURE__*/_jsx(Input, {\n          className: \"signup-input\",\n          placeholder: \"Name\",\n          type: \"text\"\n        })\n      }), /*#__PURE__*/_jsx(Form.Item, {\n        name: \"email\",\n        rules: [{\n          required: true,\n          message: \"Please input your email\",\n          type: \"email\"\n        }],\n        children: /*#__PURE__*/_jsx(Input, {\n          className: \"signup-input\",\n          placeholder: \"Email\",\n          type: \"email\"\n        })\n      }), /*#__PURE__*/_jsx(Form.Item, {\n        name: \"password\",\n        rules: [{\n          required: true,\n          message: \"Please input password\"\n        }],\n        children: /*#__PURE__*/_jsx(Input.Password, {\n          className: \"signup-input px-6 py-4 bg-inputBg\",\n          placeholder: \"Password\"\n        })\n      }), /*#__PURE__*/_jsx(Text, {\n        className: \"mb-6\",\n        children: \"Have a referral code?\"\n      }), /*#__PURE__*/_jsx(Form.Item, {\n        children: /*#__PURE__*/_jsxs(Button, {\n          className: \"py-6 flex flex-row gap-2 justify-center items-center\",\n          block: true,\n          type: \"primary\",\n          htmlType: \"submit\",\n          onClick: function onClick() {\n            return continueHandler();\n          },\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            children: \"Continue\"\n          }), loading && /*#__PURE__*/_jsx(Spin, {\n            indicator: /*#__PURE__*/_jsx(LoadingOutlined, {\n              style: {\n                fontSize: 24,\n                color: \"white\"\n              },\n              spin: true\n            })\n          })]\n        })\n      })]\n    }), /*#__PURE__*/_jsxs(Text, {\n      children: [\"By creating an account, I accept the \", /*#__PURE__*/_jsx(Text, {\n        className: \"text-red-500\",\n        children: \"Terms & Conditions\"\n      })]\n    }), /*#__PURE__*/_jsx(Text, {\n      className: \"text-center block mt-8 mb-4 font-semibold text-base md:text-xl\",\n      children: \"Or Sign Up With\"\n    }), /*#__PURE__*/_jsxs(Row, {\n      className: \"flex justify-center items-center gap-2 md:gap-4\",\n      children: [/*#__PURE__*/_jsx(FacebookLoginComp, {\n        handler: facebookHandler\n      }), /*#__PURE__*/_jsx(GoogleLoginComp, {\n        handler: googleHandler\n      })]\n    })]\n  });\n};\n\nexport default Step1;","map":null,"metadata":{},"sourceType":"module"}