{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { LoadingOutlined } from '@ant-design/icons';\nimport { Button, Form, message, Spin, Typography } from 'antd';\nimport React, { useState } from 'react';\nimport axiosClient from '../../../../../utils/axios-config';\nimport OTPInput from './OTPInput';\n\nvar Step2 = function Step2(_ref) {\n  var form = _ref.form,\n      prevStep = _ref.prevStep,\n      nextStep = _ref.nextStep,\n      onClick = _ref.onClick;\n\n  var _useState = useState(\"\"),\n      token = _useState[0],\n      setToken = _useState[1];\n\n  var _useState2 = useState(false),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var Text = Typography.Text;\n\n  var continueHandler = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _form$getFieldsValue, email, email_token, name, password, user_type, _res, completeRegRes, _error$response, _error$response$data, _error$response2, _error$response2$data, _completeRegRes;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n              _form$getFieldsValue = form.getFieldsValue(true), email = _form$getFieldsValue.email, email_token = _form$getFieldsValue.email_token, name = _form$getFieldsValue.name, password = _form$getFieldsValue.password, user_type = _form$getFieldsValue.user_type; // verify token\n\n              _context.prev = 2;\n              _context.next = 5;\n              return axiosClient.post(\"user/verify-email-token\", {\n                email: email,\n                email_token: email_token\n              });\n\n            case 5:\n              _res = _context.sent;\n              console.log(_res); // if user doesn't already exists & is sent verification email\n\n              if (!((_res === null || _res === void 0 ? void 0 : _res.status) === 200)) {\n                _context.next = 19;\n                break;\n              }\n\n              message.success(_res.message);\n              _context.prev = 9;\n              _context.next = 12;\n              return axiosClient.post(\"user/complete-registration\", {\n                email: email,\n                name: name,\n                password: password,\n                user_type: user_type\n              });\n\n            case 12:\n              completeRegRes = _context.sent;\n\n              if ((_res === null || _res === void 0 ? void 0 : _res.status) === 200) {\n                message.success(_res.message);\n              }\n\n              _context.next = 18;\n              break;\n\n            case 16:\n              _context.prev = 16;\n              _context.t0 = _context[\"catch\"](9);\n\n            case 18:\n              nextStep();\n\n            case 19:\n              _context.next = 34;\n              break;\n\n            case 21:\n              _context.prev = 21;\n              _context.t1 = _context[\"catch\"](2);\n              message.error(_context.t1 === null || _context.t1 === void 0 ? void 0 : (_error$response = _context.t1.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message);\n\n              if (!((_error$response2 = _context.t1.response) !== null && _error$response2 !== void 0 && (_error$response2$data = _error$response2.data.message) !== null && _error$response2$data !== void 0 && _error$response2$data.includes(\"Already Verified\"))) {\n                _context.next = 34;\n                break;\n              }\n\n              _context.prev = 25;\n              _context.next = 28;\n              return axiosClient.post(\"user/complete-registration\", {\n                email: email,\n                name: name,\n                password: password,\n                user_type: user_type\n              });\n\n            case 28:\n              _completeRegRes = _context.sent;\n              message.success(res.message);\n              _context.next = 34;\n              break;\n\n            case 32:\n              _context.prev = 32;\n              _context.t2 = _context[\"catch\"](25);\n\n            case 34:\n              setLoading(false);\n              console.log(\"No errors FOUND\");\n\n            case 36:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 21], [9, 16], [25, 32]]);\n    }));\n\n    return function continueHandler() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"flex flex-row justify-between align-center mb-6\",\n      children: [/*#__PURE__*/_jsx(Text, {\n        className: \"text-4xl font-extrabold\",\n        children: \"Verify Your Account\"\n      }), /*#__PURE__*/_jsx(\"img\", {\n        src: \"/images/close.png\",\n        alt: \"close\",\n        className: \"h-4 w-4 cursor-pointer\",\n        onClick: onClick\n      })]\n    }), /*#__PURE__*/_jsx(Text, {\n      className: \"my-8\",\n      children: \"Enter 4-digit code you have sent received your email Phone number\"\n    }), /*#__PURE__*/_jsxs(Form, {\n      form: form,\n      name: \"signup-form\",\n      autoComplete: \"off\",\n      className: \"mt-10\",\n      layout: \"vertical\",\n      children: [/*#__PURE__*/_jsx(OTPInput, {\n        autoFocus: true,\n        isNumberInput: true,\n        length: 4,\n        className: \"otpContainer flex gap-2\",\n        inputClassName: \"otpInput px-4 py-4 bg-inputBg w-16 h-16\",\n        onChangeOTP: function onChangeOTP(otp) {\n          return form.setFields([{\n            name: \"email_token\",\n            value: otp\n          }]);\n        }\n      }), /*#__PURE__*/_jsxs(Button, {\n        className: \"py-6 flex my-4 mt-12 flex-row gap-2 justify-center items-center\",\n        block: true,\n        type: \"primary\",\n        htmlType: \"submit\",\n        onClick: function onClick() {\n          return continueHandler();\n        },\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          children: \"Continue\"\n        }), loading && /*#__PURE__*/_jsx(Spin, {\n          indicator: /*#__PURE__*/_jsx(LoadingOutlined, {\n            style: {\n              fontSize: 24,\n              color: \"white\"\n            },\n            spin: true\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(Button, {\n        className: \"py-6 flex flex-row gap-2 justify-center items-center mt-0\",\n        block: true,\n        type: \"default\",\n        htmlType: \"submit\",\n        onClick: function onClick() {\n          return prevStep();\n        },\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          children: \"Back\"\n        }), loading && /*#__PURE__*/_jsx(Spin, {\n          indicator: /*#__PURE__*/_jsx(LoadingOutlined, {\n            style: {\n              fontSize: 24,\n              color: \"white\"\n            },\n            spin: true\n          })\n        })]\n      })]\n    })]\n  });\n};\n\nexport default Step2;","map":null,"metadata":{},"sourceType":"module"}