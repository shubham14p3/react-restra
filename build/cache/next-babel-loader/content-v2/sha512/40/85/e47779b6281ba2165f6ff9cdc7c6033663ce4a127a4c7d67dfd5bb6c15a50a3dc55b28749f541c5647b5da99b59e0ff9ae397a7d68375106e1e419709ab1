{"ast":null,"code":"import Router from \"next/router\";\nimport NProgress from \"nprogress\";\nlet timer;\nlet state;\nlet activeRequests = 0;\nconst delay = 250;\n\nfunction load() {\n  if (state === \"loading\") {\n    return;\n  }\n\n  state = \"loading\";\n  timer = setTimeout(function () {\n    NProgress.start();\n  }, delay); // only show progress bar if it takes longer than the delay\n}\n\nfunction stop() {\n  if (activeRequests > 0) {\n    return;\n  }\n\n  state = \"stop\";\n  clearTimeout(timer);\n  NProgress.done();\n}\n\nRouter.events.on(\"routeChangeStart\", load);\nRouter.events.on(\"routeChangeComplete\", stop);\nRouter.events.on(\"routeChangeError\", stop);\nconst originalFetch = window.fetch;\n\nwindow.fetch = async function (...args) {\n  if (activeRequests === 0) {\n    load();\n  }\n\n  activeRequests++;\n\n  try {\n    const response = await originalFetch(...args);\n    return response;\n  } catch (error) {\n    return Promise.reject(error);\n  } finally {\n    activeRequests -= 1;\n\n    if (activeRequests === 0) {\n      stop();\n    }\n  }\n};\n\nexport default function () {\n  return null;\n}","map":null,"metadata":{},"sourceType":"module"}