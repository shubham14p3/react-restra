{"ast":null,"code":"import NextAuth from 'next-auth';\nimport Providers from 'next-auth/providers';\nimport axios from 'axios'; // For more information on each option (and a full list of options) go to\n// https://next-auth.js.org/configuration/options\n\nconst options = {\n  // https://next-auth.js.org/configuration/providers\n  providers: [Providers.Credentials({\n    id: 'cheffyCredentials',\n    name: 'CheffyCredentials',\n    authorize: async credentials => {\n      try {\n        // console.log(\"credentials :\", credentials);\n        if (credentials.apiToken) {\n          // Any object returned will be saved in `user` property of the JWT\n          return Promise.resolve(credentials);\n        } else {\n          throw new Error('apiToken token is not define');\n        }\n      } catch (error) {\n        console.log('error', error);\n        return Promise.resolve(null); //   const errorCode = error.response?.data.message[0].messages[0].id;\n        //   const errorMessage =\n        //     error.response?.data.message[0].messages[0].message;\n        //   console.log(\"errorCode : \", errorCode);\n        //   console.log(\"errorMessage : \", errorMessage);\n        //   return Promise.reject(\n        //     `/auth/signin?form=${credentials.formType}&errorCode=${errorCode}&errorMessage=${errorMessage}`\n        //   );\n      }\n    }\n  })],\n  session: {\n    jwt: true\n  },\n  jwt: {// secret: process.env.JWT_SECRET\n  },\n  callbacks: {\n    signIn: async (user, account, profile) => {\n      // console.log(\"signIn user\", user);\n      // console.log(\"signIn account\", account);\n      // console.log(\"signIn profile\", profile);\n      user.role = await user.role;\n      user.userId = await user.id;\n      return true;\n    },\n    redirect: async (url, baseUrl) => {\n      // console.log('url', url);\n      // console.log('baseUrl', baseUrl);\n      return url.startsWith(baseUrl) ? Promise.resolve(url) : Promise.resolve(baseUrl);\n    },\n    session: async (session, user) => {\n      // console.log(\"session\", session);\n      // console.log(\"session user\", user);\n      if (user.apiToken) {\n        session.apiToken = user.apiToken;\n        session.role = user.role;\n        session.userId = user.userId;\n      }\n\n      return session;\n    },\n    jwt: async (token, user, account, profile, isNewUser) => {\n      // console.log(\"jwt token\", token);\n      // console.log(\"jwt user 222222\", user);\n      const isSignIn = user ? true : false;\n\n      if (isSignIn) {\n        token.apiToken = user.apiToken;\n        token.role = user.role;\n        token.userId = user.id;\n      }\n\n      return token;\n    }\n  },\n  // Events are useful for logging\n  // https://next-auth.js.org/configuration/events\n  events: {},\n  //   pages: {\n  //     signIn: '/login'\n  //   },\n  // Enable debug messages in the console if you are having problems\n  debug: true\n};\nexport default ((req, res) => NextAuth(req, res, options));","map":null,"metadata":{},"sourceType":"module"}